<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<title>GUARDIANS // INFINITY CORE CONTAINMENT</title>

<style>
  :root{
    --cyan:#00eaff;
    --red:#ff2b2b;
    --good:#5dffb2;
    --warn:#ffd65d;
    --bg:#000;

    --panel: rgba(0,0,0,0.38);
    --border: rgba(0,234,255,0.28);

    /* Orb decay controls (0..1) */
    --decay: 0;
    --decayGlow: 0.35; /* base glow intensity */
  }

  *{ box-sizing:border-box; }

  html{
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }
  body{
    margin:0;
    min-height:100vh;
    background:var(--bg);
    color:var(--cyan);
    font-family:"Courier New", monospace;
    overflow-x:hidden;
    overflow-y:auto;
  }

  /* ===== Galaxy Background ===== */
  .galaxy{
    position:fixed; inset:0;
    background:
      radial-gradient(1200px 800px at 20% 30%, rgba(0,234,255,0.10), transparent 55%),
      radial-gradient(900px 600px at 80% 70%, rgba(255,255,255,0.06), transparent 60%),
      radial-gradient(700px 700px at 50% 50%, rgba(255,0,200,0.05), transparent 60%),
      radial-gradient(900px 900px at 10% 90%, rgba(0,80,255,0.08), transparent 60%),
      radial-gradient(900px 900px at 90% 10%, rgba(0,255,140,0.06), transparent 60%),
      #000;
    animation: drift 18s linear infinite;
    filter: saturate(1.2) contrast(1.1);
    z-index:-3;
  }
  @keyframes drift{
    0%{ transform: scale(1) translate(0,0); }
    50%{ transform: scale(1.05) translate(-1.5%, 1.5%); }
    100%{ transform: scale(1) translate(0,0); }
  }

  .stars,.stars2{
    position:fixed; inset:-200px;
    background-image:
      radial-gradient(2px 2px at 10% 20%, rgba(255,255,255,0.7), transparent 60%),
      radial-gradient(1px 1px at 30% 80%, rgba(255,255,255,0.6), transparent 60%),
      radial-gradient(1px 1px at 70% 40%, rgba(255,255,255,0.55), transparent 60%),
      radial-gradient(2px 2px at 90% 70%, rgba(255,255,255,0.7), transparent 60%),
      radial-gradient(1px 1px at 55% 15%, rgba(255,255,255,0.5), transparent 60%),
      radial-gradient(1px 1px at 15% 65%, rgba(255,255,255,0.5), transparent 60%),
      radial-gradient(2px 2px at 45% 55%, rgba(255,255,255,0.65), transparent 60%),
      radial-gradient(1px 1px at 80% 25%, rgba(255,255,255,0.5), transparent 60%);
    background-size: 900px 900px;
    opacity:0.55;
    animation: starScroll 28s linear infinite;
    z-index:-2;
  }
  .stars2{
    background-size: 650px 650px;
    opacity:0.35;
    animation-duration: 42s;
    filter: blur(0.4px);
    z-index:-1;
  }
  @keyframes starScroll{
    0%{ transform: translateY(0); }
    100%{ transform: translateY(120px); }
  }

  /* ===== Glitch Scanlines ===== */
  .glitch-lines{
    pointer-events:none;
    position:absolute; inset:0;
    background:
      repeating-linear-gradient(
        to bottom,
        rgba(0,234,255,0.03),
        rgba(0,234,255,0.03) 1px,
        transparent 2px,
        transparent 6px
      );
    mix-blend-mode: screen;
    opacity:0.35;
    animation: scan 2.8s linear infinite;
    border-radius: 18px;
  }
  @keyframes scan{
    0%{ transform: translateY(-12px); }
    100%{ transform: translateY(12px); }
  }

  /* ===== Main Wrapper ===== */
  .wrap{
    width:min(980px, 92vw);
    margin: 18px auto 40px;
    padding: 18px 18px 24px;
    border:1px solid rgba(0,234,255,0.35);
    border-radius: 18px;
    background: linear-gradient(180deg, rgba(0,234,255,0.08), rgba(0,0,0,0.55));
    box-shadow: 0 0 30px rgba(0,234,255,0.12);
    position:relative;
  }

  .header{
    display:flex;
    gap:14px;
    align-items:flex-start;
    justify-content:space-between;
    flex-wrap:wrap;
  }

  .title{
    text-align:left;
    line-height:1.1;
  }

  .title h1{
    margin:0;
    font-size: clamp(16px, 3.2vw, 22px);
    letter-spacing: 3px;
    text-transform: uppercase;
    animation: flicker 3.2s infinite;
  }
  .title .sub{
    margin-top:6px;
    font-size: clamp(10px, 2.4vw, 12px);
    letter-spacing: 2px;
    color: rgba(0,234,255,0.82);
  }
  @keyframes flicker{
    0%, 100%{ opacity: 1; }
    50%{ opacity: 0.68; }
    52%{ opacity: 0.9; }
    55%{ opacity: 0.62; }
    58%{ opacity: 0.95; }
  }

  .rightStatus{
    text-align:right;
    font-size: clamp(10px, 2.4vw, 12px);
    letter-spacing:2px;
    color: rgba(255,255,255,0.7);
  }

  /* ===== Layout ===== */
  .coreRow{
    display:grid;
    grid-template-columns: 1fr;
    gap: 16px;
    margin-top: 16px;
    align-items:start;
  }
  @media (min-width: 860px){
    .coreRow{
      grid-template-columns: 260px 1fr;
      gap: 22px;
    }
  }

  /* ===== Orb (DECAY) ===== */
  .orbWrap{
    width: fit-content;
    margin: 0 auto;
    position:relative;
  }

  .orb{
    width: 190px;
    height: 190px;
    border-radius: 50%;
    margin: 0 auto;
    position:relative;
    overflow:hidden;
    transition: filter .2s ease, transform .2s ease;

    /* Decay dims and shifts */
    filter:
      brightness(calc(1 - (var(--decay) * 0.22)))
      saturate(calc(1 - (var(--decay) * 0.18)))
      contrast(calc(1 + (var(--decay) * 0.10)));

    /* Base surface */
    background:
      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.85), rgba(0,234,255,0.35) 25%, rgba(0,0,0,0.95) 70%),
      radial-gradient(circle at 70% 70%, rgba(255,0,200,0.18), transparent 55%);
    box-shadow:
      0 0 calc(18px - (var(--decay) * 7px)) rgba(0,234,255, calc(0.35 - (var(--decay) * 0.15))),
      0 0 calc(48px - (var(--decay) * 18px)) rgba(0,234,255, calc(0.18 - (var(--decay) * 0.08)));
  }

  @media (min-width: 860px){
    .orb{ width: 210px; height: 210px; }
  }

  /* Internal swirl */
  .orb::before{
    content:"";
    position:absolute; inset:-30%;
    background:
      conic-gradient(from 90deg,
        rgba(0,234,255,0.0),
        rgba(0,234,255,0.25),
        rgba(255,255,255,0.12),
        rgba(0,0,0,0),
        rgba(255,0,200,0.15),
        rgba(0,234,255,0.0));
    animation: spin 4.2s linear infinite;
    filter: blur(1px) contrast(1.1);
    opacity: calc(0.85 - (var(--decay) * 0.25));
  }

  /* Glow pulse (weakens with decay, but flickers more) */
  .orb::after{
    content:"";
    position:absolute; inset:0;
    background:
      radial-gradient(circle at 40% 55%, rgba(0,234,255,0.35), transparent 55%),
      radial-gradient(circle at 60% 35%, rgba(255,255,255,0.14), transparent 55%),
      radial-gradient(circle at 50% 50%, rgba(0,0,0,0.1), transparent 60%);
    mix-blend-mode: screen;
    animation: pulse 1.6s ease-in-out infinite;
    opacity: calc(0.60 - (var(--decay) * 0.18));
  }

  @keyframes spin{ to{ transform: rotate(360deg); } }
  @keyframes pulse{
    0%, 100%{ transform: scale(1); }
    50%{ transform: scale(1.02); }
  }

  /* Crack layer (fades IN as decay rises) */
  .cracks{
    position:absolute;
    inset: -10%;
    border-radius: 50%;
    pointer-events:none;
    opacity: calc(var(--decay) * 0.95);
    mix-blend-mode: screen;
    filter: blur(0.2px);
    background:
      repeating-linear-gradient(120deg,
        rgba(255,255,255,0.0) 0px,
        rgba(255,255,255,0.0) 18px,
        rgba(0,234,255,0.30) 19px,
        rgba(0,234,255,0.0) 21px
      ),
      repeating-linear-gradient(35deg,
        rgba(255,255,255,0.0) 0px,
        rgba(255,255,255,0.0) 26px,
        rgba(255,0,200,0.20) 27px,
        rgba(255,255,255,0.0) 29px
      );
    transform: rotate(-12deg);
    animation: crackDrift 3.4s ease-in-out infinite;
  }
  @keyframes crackDrift{
    0%,100%{ transform: rotate(-12deg) translate(0,0); }
    50%{ transform: rotate(-10deg) translate(2px,-2px); }
  }

  /* Decay “embers” (tiny particles) */
  .embers{
    position:absolute;
    inset:0;
    border-radius:50%;
    pointer-events:none;
    opacity: calc(var(--decay) * 0.65);
    background-image:
      radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,0.35), transparent 60%),
      radial-gradient(1px 1px at 65% 40%, rgba(255,0,200,0.25), transparent 60%),
      radial-gradient(1px 1px at 50% 75%, rgba(0,234,255,0.30), transparent 60%),
      radial-gradient(2px 2px at 75% 70%, rgba(255,255,255,0.25), transparent 60%),
      radial-gradient(1px 1px at 35% 60%, rgba(255,43,43,0.22), transparent 60%);
    animation: emberFloat 2.2s linear infinite;
    mix-blend-mode: screen;
  }
  @keyframes emberFloat{
    0%{ transform: translateY(0); }
    100%{ transform: translateY(-10px); }
  }

  /* Glitch shimmer band (appears late decay) */
  .shimmer{
    position:absolute;
    inset:-10%;
    border-radius:50%;
    pointer-events:none;
    opacity: calc((var(--decay) - 0.55) * 1.8);
    background:
      linear-gradient(90deg,
        rgba(0,0,0,0) 0%,
        rgba(0,234,255,0.18) 45%,
        rgba(255,255,255,0.10) 50%,
        rgba(255,43,43,0.10) 55%,
        rgba(0,0,0,0) 100%);
    transform: rotate(18deg) translateX(-30%);
    animation: shimmerMove 0.9s linear infinite;
    mix-blend-mode: screen;
    filter: blur(0.6px);
  }
  @keyframes shimmerMove{
    0%{ transform: rotate(18deg) translateX(-40%); }
    100%{ transform: rotate(18deg) translateX(40%); }
  }

  /* Shake is driven by JS at critical threshold */
  .shake{ animation: shake 0.2s infinite; }
  @keyframes shake{
    0%{ transform: translate(0,0); }
    25%{ transform: translate(1px,-1px); }
    50%{ transform: translate(-1px,1px); }
    75%{ transform: translate(1px,1px); }
    100%{ transform: translate(-1px,-1px); }
  }

  /* Orb “stabilize” flash */
  .stabilize{
    filter: brightness(1.15) saturate(1.2) !important;
    transform: scale(1.01);
  }

  .statusBar{
    margin-top:14px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
    flex-wrap:wrap;
    font-size: 12px;
    letter-spacing:2px;
    color: rgba(255,255,255,0.7);
  }

  /* ===== Panels ===== */
  .panel{
    border:1px solid var(--border);
    border-radius:14px;
    padding:14px 14px 12px;
    background: var(--panel);
  }
  .panel h2{
    margin:0 0 10px;
    font-size: 13px;
    letter-spacing:2px;
    color: rgba(0,234,255,0.92);
    text-transform: uppercase;
  }

  .statusText{
    margin-top:8px;
    font-size: clamp(12px, 2.7vw, 14px);
    letter-spacing:1.6px;
    text-align:left;
    line-height:1.55;
  }

  .good{ color: var(--good); }
  .bad{ color: var(--red); }
  .warn{ color: var(--warn); }

  .actions{
    margin-top: 10px;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:flex-start;
  }
  button{
    background: rgba(0,234,255,0.95);
    color:black;
    border:none;
    padding:10px 14px;
    border-radius: 12px;
    cursor:pointer;
    font-weight:700;
    letter-spacing:1px;
    flex: 1 1 180px;
  }
  button.secondary{
    background: rgba(255,255,255,0.12);
    color: rgba(255,255,255,0.92);
    border: 1px solid rgba(255,255,255,0.18);
  }
  button.danger{
    background: rgba(255,43,43,0.95);
    color:black;
  }

  .tinyNote{
    margin-top:12px;
    font-size: 12px;
    color: rgba(255,255,255,0.65);
    letter-spacing: 1px;
    line-height: 1.55;
  }

  /* ===== Boot / Loading ===== */
  .boot{
    position:fixed; inset:0;
    display:grid; place-items:center;
    background:#000;
    z-index: 9998;
  }
  .bootBox{
    width:min(820px, 92vw);
    border:1px solid rgba(0,234,255,0.35);
    border-radius:18px;
    padding: 20px 20px 18px;
    background: rgba(0,0,0,0.55);
    box-shadow: 0 0 30px rgba(0,234,255,0.12);
    position:relative;
    overflow:hidden;
  }
  .bootTitle{
    text-transform:uppercase;
    letter-spacing:3px;
    font-size: clamp(14px, 3vw, 18px);
    margin:0 0 8px;
    animation: flicker 3.2s infinite;
  }
  .bootLog{
    margin:0;
    font-size: clamp(10px, 2.5vw, 12px);
    letter-spacing:2px;
    color: rgba(255,255,255,0.75);
    line-height:1.6;
    min-height: 150px;
    white-space:pre-wrap;
  }
  .bar{
    margin-top:14px;
    height: 10px;
    border-radius: 999px;
    border:1px solid rgba(0,234,255,0.35);
    overflow:hidden;
  }
  .fill{
    height:100%;
    width:0%;
    background: rgba(0,234,255,0.9);
    transition: width 0.25s linear;
  }
  .bootHint{
    margin-top: 12px;
    font-size: 11px;
    letter-spacing:2px;
    color: rgba(255,255,255,0.6);
  }

  /* ===== Overlays ===== */
  .overlay{
    position:fixed; inset:0;
    display:none;
    place-items:center;
    z-index: 9999;
    text-align:center;
    backdrop-filter: blur(2px);
    padding: 18px;
  }
  .overlay .card{
    width:min(860px, 92vw);
    border-radius: 18px;
    padding: 24px 18px;
    border:1px solid rgba(255,255,255,0.15);
    background: rgba(0,0,0,0.70);
    box-shadow: 0 0 40px rgba(0,0,0,0.6);
  }
  .overlay h1{
    margin:0 0 10px;
    font-size: clamp(22px, 4.8vw, 34px);
    letter-spacing:5px;
    text-transform: uppercase;
  }
  .overlay p{
    margin:0;
    font-size: clamp(11px, 2.6vw, 12px);
    letter-spacing:2px;
    line-height:1.7;
    color: rgba(255,255,255,0.85);
  }

  .granted{
    background: radial-gradient(900px 700px at 50% 50%, rgba(93,255,178,0.12), transparent 60%);
  }
  .granted h1{ color: var(--good); }
  .granted .card{
    border-color: rgba(93,255,178,0.35);
    box-shadow: 0 0 50px rgba(93,255,178,0.12);
  }

  .denied{
    background: radial-gradient(900px 700px at 50% 50%, rgba(255,43,43,0.12), transparent 60%);
    animation: denyPulse 0.18s infinite;
  }
  @keyframes denyPulse{
    0%{ filter: contrast(1.1); }
    50%{ filter: contrast(1.35); }
    100%{ filter: contrast(1.1); }
  }
  .denied h1{ color: var(--red); }
  .denied .card{
    border-color: rgba(255,43,43,0.35);
    box-shadow: 0 0 50px rgba(255,43,43,0.12);
  }

  .holdOverlay{
    background: radial-gradient(900px 700px at 50% 50%, rgba(0,234,255,0.10), transparent 60%);
  }
  .holdOverlay .card{
    border-color: rgba(0,234,255,0.35);
    box-shadow: 0 0 50px rgba(0,234,255,0.10);
  }
  .holdOverlay h1{ color: var(--cyan); }

  /* ===== Readable glitch headline (ONLY headline line) ===== */
  .glitchHeadline{
    position:relative;
    display:inline-block;
    font-weight:700;
  }
  .glitchHeadline::before,
  .glitchHeadline::after{
    content: attr(data-text);
    position:absolute;
    left:0; top:0;
    width:100%;
    opacity:0.55;
    pointer-events:none;
  }
  .glitchHeadline::before{
    transform: translate(1px, 0);
    color: rgba(255,43,43,0.9);
    clip-path: inset(0 0 60% 0);
    animation: gh1 1.4s infinite steps(2,end);
  }
  .glitchHeadline::after{
    transform: translate(-1px, 0);
    color: rgba(0,234,255,0.9);
    clip-path: inset(60% 0 0 0);
    animation: gh2 1.8s infinite steps(2,end);
  }
  @keyframes gh1{
    0%{ clip-path: inset(0 0 75% 0); opacity:0.45; }
    40%{ clip-path: inset(20% 0 45% 0); opacity:0.65; }
    70%{ clip-path: inset(55% 0 10% 0); opacity:0.55; }
    100%{ clip-path: inset(0 0 75% 0); opacity:0.45; }
  }
  @keyframes gh2{
    0%{ clip-path: inset(70% 0 0 0); opacity:0.45; }
    35%{ clip-path: inset(50% 0 15% 0); opacity:0.65; }
    80%{ clip-path: inset(10% 0 55% 0); opacity:0.55; }
    100%{ clip-path: inset(70% 0 0 0); opacity:0.45; }
  }

  /* ===== Easter egg end screen ===== */
  .end{
    position:fixed; inset:0;
    display:none;
    place-items:center;
    z-index: 10001;
    background: rgba(0,0,0,0.92);
    text-align:center;
    padding: 20px;
  }
  .end .card{
    width:min(860px, 92vw);
    border-radius: 18px;
    padding: 24px 18px;
    border:1px solid rgba(0,234,255,0.28);
    background: rgba(0,0,0,0.72);
    box-shadow: 0 0 40px rgba(0,234,255,0.10);
  }
  .end h1{
    margin:0 0 10px;
    font-size: clamp(20px, 4.5vw, 30px);
    letter-spacing:4px;
    text-transform: uppercase;
    color: var(--cyan);
  }
  .end p{
    margin:0;
    font-size: clamp(12px, 2.7vw, 14px);
    letter-spacing:2px;
    line-height:1.7;
    color: rgba(255,255,255,0.86);
  }
  .end .actions{
    justify-content:center;
  }

  /* ===== Breach takeover ===== */
  .takeover{
    position:fixed; inset:0;
    display:none;
    place-items:center;
    background:#000;
    z-index: 10000;
    color: var(--red);
    text-align:center;
    padding: 20px;
  }
  .takeover h1{
    font-size: clamp(22px, 5vw, 34px);
    letter-spacing: 4px;
    margin:0 0 12px;
    text-transform: uppercase;
    animation: breachFlicker 0.8s infinite;
  }
  .takeover p{
    margin:0;
    width:min(860px, 92vw);
    color: rgba(255,255,255,0.8);
    letter-spacing: 2px;
    line-height:1.6;
    font-size: clamp(11px, 2.6vw, 12px);
  }
  @keyframes breachFlicker{
    0%{ opacity:1; }
    25%{ opacity:0.25; }
    50%{ opacity:0.9; transform: translateX(1px); }
    75%{ opacity:0.35; transform: translateX(-1px); }
    100%{ opacity:1; }
  }
  .breachFlash{ animation: flash 0.12s infinite; }
  @keyframes flash{
    0%{ background:#000; }
    50%{ background:#290000; }
    100%{ background:#000; }
  }
</style>
</head>

<body>
  <div class="galaxy"></div>
  <div class="stars"></div>
  <div class="stars2"></div>

  <!-- ===== BOOT / LOADING ===== -->
  <div class="boot" id="boot">
    <div class="bootBox">
      <div class="glitch-lines" style="border-radius:18px;"></div>
      <div class="bootTitle">NOVA CORPS HANDSHAKE • INIT</div>
      <pre class="bootLog" id="bootLog"></pre>
      <div class="bar"><div class="fill" id="bootFill"></div></div>
      <div class="bootHint">Link established → Loading containment console…</div>
    </div>
  </div>

  <!-- ===== ACCESS OVERLAYS ===== -->
  <div class="overlay granted" id="overlayGranted">
    <div class="card">
      <h1>ACCESS GRANTED</h1>
      <p>
        NOVA CORPS CLEARANCE VERIFIED<br/>
        JUMP POINT STABILIZATION AUTHORIZED<br/>
        CONTAINMENT TRANSFER: ENABLED
      </p>
    </div>
  </div>

  <div class="overlay denied" id="overlayDenied">
    <div class="card">
      <h1>ACCESS DENIED</h1>
      <p>
        CLEARANCE FAILURE DETECTED<br/>
        CORE SURGE INCREASING<br/>
        REAUTHORIZATION REQUIRED
      </p>
    </div>
  </div>

  <div class="overlay holdOverlay" id="overlayHold">
    <div class="card">
      <h1>HOLD POSITION</h1>
      <p id="holdText">
        COOL. WE’LL JUST STAND HERE<br/>
        HOLDING A REALITY-BENDING SPACE MARBLE.<br/>
        NO PRESSURE.
      </p>
    </div>
  </div>

  <!-- ===== MAIN UI ===== -->
  <div class="wrap" id="ui" style="display:none;">
    <div class="glitch-lines"></div>

    <div class="header">
      <div class="title">
        <h1>GUARDIANS // INFINITY CORE</h1>
        <div class="sub">TEMPORAL JUMP STABILIZATION • CONTAINMENT TRANSFER REQUEST</div>
      </div>
      <div class="rightStatus" id="rightStatus">
        NODE: XANDAR-RELAY-07<br/>
        SIGNAL: LOCKED<br/>
        MODE: INTAKE
      </div>
    </div>

    <div class="coreRow">
      <div>
        <div class="orbWrap">
          <div class="orb" id="orb"></div>
          <div class="cracks" id="cracks"></div>
          <div class="embers" id="embers"></div>
          <div class="shimmer" id="shimmer"></div>
        </div>

        <div class="statusBar">
          <div>CORE STATUS: <span id="coreStatus" class="warn">UNSTABLE</span></div>
          <div>INSTABILITY: <span id="timer" class="bad">45s</span></div>
        </div>
      </div>

      <!-- ===== Phase 1 ===== -->
      <div class="panel" id="panelAuth">
        <h2>Phase 1 • Priority Jump Point Request</h2>

        <div class="panel" style="margin-top:10px;">
          <h2>UNSTABLE ORB • INCURSION EVENT</h2>
          <div class="statusText" style="margin-top:6px;">
            STATUS: <span class="bad">ACTIVE</span><br/>
            INCURSION LEVEL: <span class="warn">OMEGA (LOCALIZED)</span><br/>
            REQUEST: <span class="warn">PRIORITY ACCESS</span> to Jump Point <span class="warn">XANDAR</span><br/><br/>
            RISK: Temporal shear / multiverse destabilization if intake is delayed.<br/>
            RECOMMENDATION: Immediate containment transfer + controlled boarding.
          </div>
        </div>

        <div class="statusText" id="statusText" style="margin-top:12px;">
          STATUS: <span class="warn">AWAITING AUTHORIZATION</span><br/>
          NOTE: THIS CONSOLE DOES NOT AUTO-RESET.
        </div>

        <div class="actions">
          <button onclick="authorize()">AUTHORIZE PRIORITY ACCESS</button>
          <button class="secondary" onclick="denyRequest()">DENY REQUEST</button>
        </div>

        <div class="tinyNote">
          ROUTE: <span class="warn">NOVA PRIME → XANDAR INTAKE</span> • PACKET: <span class="warn">JUMPPOINT CLEARANCE</span>
        </div>
      </div>

      <!-- ===== Granted: Boarding Instructions ===== -->
      <div class="panel" id="panelBoarding" style="display:none;">
        <h2>Access Granted • Cast Member Instructions</h2>

        <div class="statusText">
          <span class="good">PRIORITY ACCESS AUTHORIZED</span><br/>
          DESTINATION: <span class="good">JUMP POINT XANDAR</span><br/><br/>

          <span class="warn">CAST MEMBER PROMPT</span><br/>
          Please call the full party forward to <span class="good">scan bands</span> for containment transfer and boarding.<br/><br/>

          OPERATOR NOTE: Keep the party together and move directly to intake.
        </div>

        <div class="actions" style="margin-top:14px;">
          <button class="secondary" onclick="holdPosition()">HOLD POSITION</button>
          <button class="danger" onclick="forceBreach()">SIMULATE BREACH</button>
        </div>
      </div>

      <!-- ===== Denied ===== -->
      <div class="panel" id="panelDeniedGift" style="display:none;">
        <h2>Access Denied • Containment Courtesy</h2>

        <div class="statusText">
          <span class="bad">REQUEST DENIED</span><br/>
          PRIORITY ACCESS: REJECTED<br/><br/>

          <span class="warn">GUARDIANS RESPONSE</span><br/><br/>

          <span class="glitchHeadline" data-text="OKAY. WOW. BOLD MOVE.">OKAY. WOW. BOLD MOVE.</span><br/>
          “We respect it. Not smart — but we respect it.”<br/><br/>

          So here’s the deal — we are <span class="good">NOT</span> trying to unravel the multiverse today.<br/>
          And you probably aren’t either.<br/><br/>

          Therefore, as a totally generous, definitely heroic gesture…<br/><br/>

          Please accept this <span class="warn">unstable orb</span> as a token of appreciation.<br/><br/>

          (Seriously. It hums louder when it’s ignored.)
        </div>

        <div class="actions" style="margin-top:14px;">
          <button onclick="retryAuthorize()">FINE. AUTHORIZE IT.</button>
          <button class="secondary" onclick="endEasterEgg()">WE’LL HOLD IT… FOR NOW.</button>
        </div>
      </div>

    </div>
  </div>

  <!-- ===== Easter egg end screen ===== -->
  <div class="end" id="end">
    <div class="card">
      <h1>CONTAINMENT MAINTAINED</h1>
      <p>
        No multiverse collapse today.<br/><br/>
        Seriously — <span class="good">thank you</span> for everything you do.<br/>
        You keep the magic moving, even when things get… cosmic.
      </p>
      <div class="actions" style="margin-top:16px;">
        <button onclick="closeEnd()">RETURN TO CONSOLE</button>
      </div>
    </div>
  </div>

  <!-- ===== Breach takeover ===== -->
  <div class="takeover" id="takeover">
    <div id="takeoverBox">
      <h1>INFINITY CORE BREACH</h1>
      <p>
        CONTAINMENT FAILURE DETECTED • TEMPORAL SHEAR IMMINENT<br/>
        NOVA CORPS UPLINK COMPROMISED • INITIATING EMERGENCY BLACKOUT<br/><br/>
        IF YOU CAN READ THIS, YOU ARE TOO CLOSE.
      </p>
    </div>
  </div>

<script>
  // ===== State =====
  const MAX_TIME = 45;
  let timeLeft = MAX_TIME;
  let interval = null;
  let authorized = false;

  // ===== Elements =====
  const orb = document.getElementById("orb");
  const coreStatus = document.getElementById("coreStatus");
  const timerEl = document.getElementById("timer");
  const statusText = document.getElementById("statusText");
  const rightStatus = document.getElementById("rightStatus");

  const panelAuth = document.getElementById("panelAuth");
  const panelBoarding = document.getElementById("panelBoarding");
  const panelDeniedGift = document.getElementById("panelDeniedGift");

  const takeover = document.getElementById("takeover");
  const takeoverBox = document.getElementById("takeoverBox");

  const boot = document.getElementById("boot");
  const bootLog = document.getElementById("bootLog");
  const bootFill = document.getElementById("bootFill");

  const overlayGranted = document.getElementById("overlayGranted");
  const overlayDenied = document.getElementById("overlayDenied");
  const overlayHold = document.getElementById("overlayHold");
  const holdText = document.getElementById("holdText");

  const end = document.getElementById("end");

  // ===== Boot sequence =====
  const bootLines = [
    "LINK: XANDAR-RELAY-07 … CONNECTING",
    "HANDSHAKE: NOVA CORPS PROTOCOL v7.9",
    "ROUTE: NOVA PRIME UPLINK • ESTABLISHED",
    "CORE SIGNAL: UNSTABLE • TELEMETRY STREAMING",
    "JUMP POINT MODEL: LOADING",
    "CONTAINMENT SUBROUTINES: READY",
    "CONSOLE: CLEARANCE REQUIRED"
  ];

  let bootIndex = 0;
  let bootPct = 0;

  const bootTimer = setInterval(()=>{
    if(bootIndex < bootLines.length){
      bootLog.textContent += bootLines[bootIndex] + "\n";
      bootIndex++;
    }
    bootPct = Math.min(100, bootPct + 8 + Math.floor(Math.random()*8));
    bootFill.style.width = bootPct + "%";

    if(bootPct >= 100){
      clearInterval(bootTimer);
      setTimeout(()=>{
        boot.style.display = "none";
        document.getElementById("ui").style.display = "block";
        applyDecay();          // initialize visuals
        startCountdown();
      }, 450);
    }
  }, 260);

  // ===== Decay driver (0..1) =====
  function getDecay(){
    // 0 at 45s, 1 at 0s
    const d = 1 - (timeLeft / MAX_TIME);
    return Math.max(0, Math.min(1, d));
  }

  function applyDecay(){
    const d = getDecay();
    document.documentElement.style.setProperty("--decay", d.toFixed(3));

    // Status text progression (optional flavor)
    if(!authorized){
      if(d < 0.33){
        coreStatus.textContent = "UNSTABLE";
        coreStatus.className = "warn";
      }else if(d < 0.66){
        coreStatus.textContent = "DEGRADING";
        coreStatus.className = "warn";
      }else{
        coreStatus.textContent = "CRITICAL";
        coreStatus.className = "bad";
      }
    }

    // Late-stage micro-flicker (orb “jitters” without full shake)
    if(d > 0.72 && !authorized){
      const jitter = (Math.random() * 2 - 1) * 0.6; // -0.6..0.6
      orb.style.transform = `translate(${jitter}px, ${-jitter}px)`;
    } else {
      orb.style.transform = "";
    }
  }

  // ===== Countdown (no auto reset) =====
  function startCountdown(){
    if(interval) return;
    interval = setInterval(() => {
      timeLeft--;
      timerEl.textContent = `${timeLeft}s`;

      applyDecay();

      if(timeLeft <= 15 && timeLeft > 0 && !authorized){
        orb.classList.add("shake");
        rightStatus.innerHTML = `NODE: XANDAR-RELAY-07<br/>SIGNAL: DEGRADED<br/>MODE: EMERGENCY`;
      }

      if(timeLeft <= 0){
        clearInterval(interval);
        interval = null;
        meltdown(false);
      }
    }, 1000);
  }

  function showOverlay(el, ms=1000){
    el.style.display = "grid";
    setTimeout(()=>{ el.style.display = "none"; }, ms);
  }

  // ===== Primary buttons =====
  function authorize(){
    statusText.innerHTML =
      "STATUS: <span class='warn'>TRANSMITTING…</span><br/>Awaiting Nova Prime response…";

    setTimeout(()=>{
      authorized = true;

      showOverlay(overlayGranted, 1100);

      coreStatus.textContent = "AUTHORIZED";
      coreStatus.className = "good";

      rightStatus.innerHTML = `NODE: XANDAR-RELAY-07<br/>SIGNAL: GREEN<br/>MODE: AUTHORIZED`;

      panelAuth.style.display = "none";
      panelDeniedGift.style.display = "none";
      panelBoarding.style.display = "block";

      if(interval){
        clearInterval(interval);
        interval = null;
      }
      timerEl.textContent = "LOCKED";
      orb.classList.remove("shake");
      orb.style.transform = "";
      document.documentElement.style.setProperty("--decay", "0.05"); // looks “contained”, not dead
    }, 650);
  }

  function denyRequest(){
    showOverlay(overlayDenied, 950);

    coreStatus.textContent = "REJECTED";
    coreStatus.className = "bad";

    rightStatus.innerHTML = `NODE: XANDAR-RELAY-07<br/>SIGNAL: LOCKED<br/>MODE: DENIED`;

    panelAuth.style.display = "none";
    panelBoarding.style.display = "none";
    panelDeniedGift.style.display = "block";
  }

  function retryAuthorize(){
    panelAuth.style.display = "block";
    panelBoarding.style.display = "none";
    panelDeniedGift.style.display = "none";

    authorized = false;

    coreStatus.textContent = "UNSTABLE";
    coreStatus.className = "warn";

    rightStatus.innerHTML = `NODE: XANDAR-RELAY-07<br/>SIGNAL: LOCKED<br/>MODE: INTAKE`;

    statusText.innerHTML =
      "STATUS: <span class='warn'>AWAITING AUTHORIZATION</span><br/>NOTE: THIS CONSOLE DOES NOT AUTO-RESET.";

    // If countdown had ended previously, restart fresh
    if(timeLeft <= 0){
      timeLeft = MAX_TIME;
      timerEl.textContent = `${timeLeft}s`;
      applyDecay();
      startCountdown();
    }
  }

  // ===== HOLD POSITION (Guardians flavor + orb stabilize “decay rollback” moment) =====
  function holdPosition(){
    const lines = [
      "COOL. WE’LL JUST STAND HERE<br/>HOLDING A REALITY-BENDING SPACE MARBLE.<br/>NO PRESSURE.",
      "HOLDING. LIKE YOU SAID.<br/>IF THIS THING STARTS SINGING? THAT’S ON YOU.",
      "WE ARE HOLDING POSITION.<br/>PLEASE ENJOY THIS ENTIRELY NORMAL COSMIC HUM.",
      "COPY THAT.<br/>WE’LL BE OVER HERE — NOT DESTROYING REALITY. YOU’RE WELCOME."
    ];
    holdText.innerHTML = lines[Math.floor(Math.random() * lines.length)];

    // Make it feel like containment stabilizes for a moment
    orb.classList.add("stabilize");
    const currentDecay = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--decay")) || getDecay();
    const rolledBack = Math.max(0, currentDecay - 0.08);
    document.documentElement.style.setProperty("--decay", rolledBack.toFixed(3));

    setTimeout(()=>{
      orb.classList.remove("stabilize");
      applyDecay(); // returns to true decay based on timer
    }, 1400);

    showOverlay(overlayHold, 1400);
  }

  // ===== Easter egg end =====
  function endEasterEgg(){
    end.style.display = "grid";
  }
  function closeEnd(){
    end.style.display = "none";
    panelAuth.style.display = "none";
    panelBoarding.style.display = "none";
    panelDeniedGift.style.display = "block";
  }

  // ===== Breach simulation / timeout =====
  function forceBreach(){ meltdown(true); }

  function meltdown(forced){
    takeover.style.display = "grid";
    takeover.classList.add("breachFlash");
    document.getElementById("ui").style.display = "none";

    const lines = [
      "OVERRIDE: CONTAINMENT FAILED",
      "TEMPORAL SHEAR DETECTED",
      "JUMP POINT COLLAPSE IN PROGRESS",
      "NOVA CORPS UPLINK COMPROMISED",
      "LOCKING OUT LOCAL CONSOLE",
      "DO NOT APPROACH THE ORB",
      "ERROR: REALITY INTEGRITY < 12%",
      "—",
      forced ? "MANUAL BREACH INITIATED" : "TIMEOUT BREACH INITIATED"
    ];

    let i = 0;
    setInterval(()=>{
      takeoverBox.querySelector("p").innerHTML =
        lines.slice(0, Math.min(i, lines.length)).join("<br/>") +
        "<br/><br/>" +
        "<span style='color:rgba(255,255,255,0.65)'>" + randomNoise(60) + "</span>";
      if(i < lines.length) i++;
    }, 180);

    setInterval(()=>{
      takeover.style.background = (takeover.style.background === "rgb(0, 0, 0)") ? "#120000" : "#000";
    }, 120);
  }

  function randomNoise(n){
    const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()-_=+[]{}<>/\\|";
    let out = "";
    for(let i=0;i<n;i++) out += chars[Math.floor(Math.random()*chars.length)];
    return out;
  }

  // Enter key quick action
  document.addEventListener("keydown", (e)=>{
    if(e.key !== "Enter") return;
    if(panelAuth.style.display !== "none") authorize();
  });
</script>
</body>
</html>
